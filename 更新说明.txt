
V0.99.14 v20220421

- 新增: 自定义回复模块
- 新增: 配置备份和自动备份功能
- 新增: 每500条文本，log在群内做一次提醒
- 新增: 当bot off时，不允许@骰子做 log on
- 新增: 骰子bot on时，如果开着log，做出额外提醒
- 新增: log撤回支持 - 撤回的文本不会导出到最终log
- 新增: 支持通过QQ号bot on和bot off
- 新增: 风控自动重新登录(仅在有密码时)
- 新增: 部分指令加入结果记录，以便于和回声工坊对接 (命令加--ci查看)
- 新增: 支持QQ频道(默认关闭，必须bot on打开，且默认不记录消息)
- 新增: 消息通知功能: 加群邀请、好友邀请、进入群组、被踢出群、被禁言、自动激活、指令退群
- 新增: .name命令，隶属story模块。支持中文、英文(英文名+翻译)、日文(汉字+平假名)生成
- 新增: .namednd命令，隶属story模块。支持DND各种族名字生成

- 优化: UI的自定义文案界面，优化了多行文本的编辑体验
- 优化: QQ发送文本自动分段(5000字节，中文1666字)
- 优化: 限制使用 .text 恶意构造指令

- 修复: UI界面指令前缀保存失败
- 修复: 手机客户端群员被审批入群，欢迎词复读的问题
- 修复: 指令延迟时间设置在QQ群中工作不正常
- 修复: 被邀请入群时，如果是需要管理员审批，那么不会触发入群发言
- 修复: 骰点轮数过多文案使用了COC检定轮数过多文案
- 修复: COC .st 力量-1的文本错误
- 修复: log的骰主本地zip生成错误的问题


骰点表达式修改较多，单独列出:

- 新增: 支持了比较算符< <= = != >= >，例: .text {力量 > 10} // 成立输出1，否则输出0
- 新增: 支持了按位与和按位或: & | 例： .text {力量 > 10 | 敏捷 > 10} // 成立输出1，否则输出0
- 新增: 支持了三目运算符 a ? b : c  例：.text {力量 > 70 ? '你很勇哦' : '拜托你很弱哦'}
- 新增: 支持了switch case运算符 例: 参见UI界面，自定义文本 -> 娱乐 -> 今日人品
- 新增: 支持了字符串类型(仅初步支持)，可以使用"" '' ``三种来定义字符串，其中``可以插入{}来内嵌表达式，如`看看运气: {d100}`
- 新增: 支持了多行文本，同样见今日人品
- 新增: 支持if语句 例: .text {% if ($t0=d100) > 30 { $t1="aaa"} else { $t1 = 'bbb' }; $t1 %} {$t0}

跑团Log着色器

- 修复: fix


自定义变更:

修改默认的自定义文本:
- 核心:昵称_改名
- 核心:昵称_重置
- 娱乐:今日人品   - 不同人品给的提示文本不同

新增自定义文本:
- DND:先攻_查看_前缀
- DND:先攻_移除_前缀
- DND:先攻_清除列表
- DND:先攻_设置_指定单位
- DND:先攻_设置_前缀
- DND:先攻_设置_格式错误
- DND:死亡豁免_D20_附加语
- DND:死亡豁免_D1_附加语
- DND:死亡豁免_成功_附加语
- DND:死亡豁免_失败_附加语
- DND:死亡豁免_结局_伤势稳定
- DND:死亡豁免_结局_角色死亡
- DND:受到伤害_超过HP上限_附加语
- DND:受到伤害_昏迷中_附加语
- DND:受到伤害_进入昏迷_附加语


升级指南:

- 解压覆盖
- 变更的默认文本，可以在UI界面，复制备份旧的之后点小刷子重置，然后修改文案
- 注意：此版本修改了数据存储格式！建议备份data目录后进行升级！


额外提醒:

- 这两天gocqhttp似乎不太稳定（小心校园网和腾讯云），如果日志中看到没有明确理由的gocqhttp退出，多试几次
- 文本的自定义支持，一般会在某指令做好的第二个版本推出。若是草案指令则可能更久一点
- 如果页面忽然404刷不出来，那是进程崩掉了，一般重开就能解决。此时的程序log会对确保海豹后续版本的稳定性很有帮助，如果可以的话请发给我看看。
